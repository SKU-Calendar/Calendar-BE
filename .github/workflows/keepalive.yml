name: keepalive

on:
  schedule:
    - cron: "*/5 * * * *"
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping server
        run: |
          set -e
          URL="https://calendar-be-v2.onrender.com/actuator/health"
          CODE=$(curl -sS -m 20 -o /dev/null -w "%{http_code}" "$URL")
          echo "Ping $URL -> HTTP $CODE"
          if [ "$CODE" -lt 200 ] || [ "$CODE" -ge 400 ]; then
            echo "Ping failed"
            exit 1
          fi
